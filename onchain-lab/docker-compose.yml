services:
  bitcoind:
    image: bitcoin/bitcoin:27.2   # or ruimarinho/bitcoin-core:27.2
    container_name: onchain-bitcoind
    restart: unless-stopped
    command:
      - -regtest=1                 # or remove for mainnet
      - -server=1
      - -txindex=1
      - -rpcbind=0.0.0.0
      - -rpcallowip=0.0.0.0/0
      - -rpcuser=${BTC_RPC_USER}
      - -rpcpassword=${BTC_RPC_PASS}
      - -fallbackfee=0.0002
      - -printtoconsole
    ports:
      - "18443:18443"              # regtest RPC; use 8332:8332 for mainnet
    volumes:
      - bitcoin_data:/home/bitcoin/.bitcoin  # named volume (no Windows bind)

volumes:
  bitcoin_data:

